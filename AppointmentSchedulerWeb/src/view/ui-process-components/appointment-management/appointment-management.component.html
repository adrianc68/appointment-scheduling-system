<section class="main-section">

  <h1 class="m-bottom-md">Citas agendadas</h1>
  <div class="summary m-bottom-xl">
    <div class="summary-item card">
      <span class="t-muted"> Horarios registrados </span>
      <span class="fw-bold fs-xl">1</span>
    </div>
    <div class="summary-item card">
      <span class="t-muted">Horarios activos</span>
      <span class="fw-bold fs-xl">2</span>
    </div>
    <div class="summary-item card">
      <span class="t-muted">Horarios inactivos</span>
      <span class="fw-bold fs-xl">3</span>
    </div>
  </div>

  <label>Desde: </label>
  <input type="date" [ngModel]="startDate" (ngModelChange)="onDateRangeChange($event, 'start')" />
  <label>Hasta: </label>
  <input type="date" [ngModel]="endDate" (ngModelChange)="onDateRangeChange($event, 'end')" />
  <section class="data-container">
    <section class="data-actions">
      <div class="grid-input-search input container">
        <label class="input-icon" for="search">
          <mat-icon>search</mat-icon>
        </label>
        <input id="search" class="input" type="text" placeholder="Buscar..." />
      </div>
      <button class="button primary w-auto" (click)="redirectToRegisterAppointment()">
        Registrar
      </button>

    </section>

    <div class="data-header">
      <span class="fw-bold">Citas agendadas</span>
    </div>
    <div class="data-body">
      <ul class="slot-container">
        <li class="card-container card muted" *ngFor="let appointment of scheduledAppointments; let i = index">
          <div class="card-header" [class.expanded]="openedSlots.has(i)" (click)="toggleSlot(i)">
            <div class="card-icon">
              <mat-icon>person</mat-icon>
            </div>
            <div class="card-title d-flex">
              <div class="d-flex-col">
                <span class="fs-base fw-bold t-emphasis m-bottom-base">
                  Cita con {{ appointment.client!.name}}
                </span>
                <span class="fs-sm t-muted">
                  {{ appointment.startDate | slotDateRange: (appointment.endDate)}}
                </span>
              </div>
              <span class="fs-xs fw-bold" [ngClass]="{
        't-success': appointment.status === 'CONFIRMED',
        't-brand': appointment.status === 'SCHEDULED',
        't-danger': appointment.status === 'CANCELED',
        't-inverted': appointment.status === 'RESCHEDULED',
        't-muted': appointment.status === 'FINISHED',}">
                {{ appointment.status }}
              </span>
            </div>

            <button [class.clicked]="openedSlots.has(i)">
              <mat-icon>
                keyboard_arrow_right
              </mat-icon>
            </button>

          </div>
          <div class="card-body" [class.expanded]="openedSlots.has(i)">
            <div class="wrapper p-left-md p-right-md">
              <div class="slot-data-row">
                <div class="slot-data">
                  <span class="fs-base t-muted">
                    $ {{ appointment.totalCost }}
                  </span>
                  <ul class="w-100 bg-blue">
                    <li class="" *ngFor="let selectedService of appointment.scheduledServices">
                      <div class="d-flex gap-lg">
                        <div class="d-flex m-bottom-base">
                          <span class="t-muted">
                            Servicio:
                          </span>
                          <span class="t-emphasis m-left-base">
                            {{ selectedService.service.name }}
                          </span>
                        </div>
                      </div>
                      <div class="d-flex m-bottom-base">
                        <span class="m-botom-base t-muted">
                          Asistente:
                        </span>
                        <span class="t-emphasis m-left-base">
                          {{ selectedService.assistant.name}}
                        </span>
                      </div>
                      <div class="d-flex-col m-bottom-base">
                        <span class="m-bottom-base t-muted">
                          Fecha de servicio:
                        </span>
                        <span class="t-emphasis">
                          {{ selectedService.service.startDate | slotDateRange: (selectedService.service.endDate) }}
                        </span>
                      </div>

                      <br>
                      <br>
                      <br>
                      <span>
                        {{ selectedService.service.startDate | slotDateRange: (selectedService.service.endDate) }}
                      </span>
                      <span>
                        {{ selectedService.assistant.name }}
                      </span>
                      <span>
                        {{ selectedService.assistant.username }}
                      </span>
                      <span>
                        {{ selectedService.assistant.phoneNumber }}
                      </span>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="slot-data-row">
                <div class="slot-data">
                </div>
              </div>
              <div class="slot-actions">
                <span class="t-muted m-bottom-base">Acciones:</span>
                <div class="actions">
                  <!--<button (click)="redirectToEditSlot(slot)" class="button unbordered">-->
                  <!--<span class="t-brand fs-sm">Editar</span>-->
                  <!--</button>-->
                </div>
              </div>
            </div>
          </div>
        </li>
      </ul>

    </div>

  </section>


  <!--<pre>-->
  <!--  <span>-->
  <!--    {{ scheduledAppointments | json}}-->
  <!---->
  <!--  </span>-->
  <!--</pre>-->

</section>
